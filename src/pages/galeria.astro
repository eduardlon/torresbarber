---
export const prerender = false;
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { supabase } from '../db/supabase.js';
import type { GaleriaItem } from '../services/supabaseService';

const { data: cortesData, error: cortesError } = await supabase
  .from('galeria_items')
  .select('*')
  .eq('tipo', 'corte')
  .eq('activo', true)
  .order('destacado', { ascending: false })
  .order('created_at', { ascending: false });

if (cortesError) {
  console.error('Error al cargar cortes:', cortesError);
}

const { data: gorrasData, error: gorrasError } = await supabase
  .from('galeria_items')
  .select('*')
  .eq('tipo', 'gorra')
  .eq('activo', true)
  .order('destacado', { ascending: false })
  .order('created_at', { ascending: false });

if (gorrasError) {
  console.error('Error al cargar gorras:', gorrasError);
}

const { data: vapesData, error: vapesError } = await supabase
  .from('galeria_items')
  .select('*')
  .eq('tipo', 'vape')
  .eq('activo', true)
  .order('destacado', { ascending: false })
  .order('created_at', { ascending: false });

if (vapesError) {
  console.error('Error al cargar vapes:', vapesError);
}

const FALLBACK_IMAGES: Record<string, string> = {
  corte: 'https://images.unsplash.com/photo-1621605815971-fbc98d665033?w=800&h=600&fit=crop&crop=center',
  gorra: 'https://images.unsplash.com/photo-1588850561407-ed78c282e89b?w=800&h=600&fit=crop&crop=center',
  vape: 'https://images.unsplash.com/photo-1616401784845-180882ba9ba9?w=800&h=600&fit=crop&crop=center',
  default: 'https://images.unsplash.com/photo-1522335789203-aabd1fc54bc9?w=800&h=600&fit=crop&crop=center',
};

const mapGaleriaImagenes = (imagenes: string[] | null | undefined) => {
  if (!imagenes || imagenes.length === 0) {
    return [];
  }

  return imagenes
    .filter((url): url is string => typeof url === 'string' && url.trim().length > 0)
    .map((url) => {
      if (/^https?:\/\//i.test(url)) {
        return url;
      }

      const base = import.meta.env.PUBLIC_SUPABASE_URL ?? '';
      if (!base) {
        return url;
      }

      const normalized = url.startsWith('galeria/') ? url.replace(/^galeria\//, '') : url;
      return `${base}/storage/v1/object/public/galeria/${normalized}`;
    });
};

const formatPrecio = (precio: number | null | undefined) => {
  if (typeof precio !== 'number' || Number.isNaN(precio)) {
    return '—';
  }

  try {
    return precio.toLocaleString('es-CO', {
      style: 'currency',
      currency: 'COP',
      maximumFractionDigits: 0,
    });
  } catch (error) {
    console.warn('No se pudo formatear el precio', precio, error);
    return `$${precio.toFixed(0)}`;
  }
};

const formatSabores = (sabores: string[]) => {
  if (!sabores.length) {
    return null;
  }

  return sabores.join(', ');
};

const createItem = (row: GaleriaItem) => {
  const metadata = (row.metadata as Record<string, unknown> | null | undefined) ?? {};
  const imagenes = mapGaleriaImagenes(row.imagenes ?? []);
  const primaryImage = imagenes[0] ?? FALLBACK_IMAGES[row.tipo] ?? FALLBACK_IMAGES.default;
  const colores = Array.isArray(row.colores)
    ? row.colores.filter((color): color is string => typeof color === 'string')
    : [];
  const sabores = Array.isArray(row.sabores)
    ? row.sabores.filter((sabor): sabor is string => typeof sabor === 'string')
    : [];
  const tags = Array.isArray(row.tags)
    ? row.tags.filter((tag): tag is string => typeof tag === 'string')
    : [];
  const caracteristicas = Array.isArray((metadata as Record<string, unknown>).caracteristicas)
    ? ((metadata as Record<string, unknown>).caracteristicas as unknown[]).filter((caracteristica): caracteristica is string => typeof caracteristica === 'string' && caracteristica.trim().length > 0)
    : [];

  const infoLabel = (() => {
    if (row.tipo === 'corte') {
      const duracion = metadata?.duracion as string | number | undefined;
      const duracionEstimada = metadata?.duracion_estimada as string | number | undefined;

      if (typeof duracion === 'number') {
        return `${duracion} min`;
      }

      if (typeof duracion === 'string' && duracion.trim().length > 0) {
        return duracion;
      }

      if (typeof duracionEstimada === 'number') {
        return `${duracionEstimada} min`;
      }

      if (typeof duracionEstimada === 'string' && duracionEstimada.trim().length > 0) {
        return duracionEstimada;
      }

      return null;
    }

    if (row.tipo === 'gorra') {
      if (typeof row.stock === 'number') {
        return `${row.stock} en stock`;
      }
      return null;
    }

    if (row.tipo === 'vape') {
      const nicotina = typeof row.nicotina_mg === 'number' ? `${row.nicotina_mg} mg` : null;
      const saboresLabel = sabores.length ? `${sabores.length} sabores` : null;
      const pieces = [nicotina, saboresLabel].filter((value): value is string => Boolean(value));
      return pieces.length ? pieces.join(' • ') : null;
    }

    return null;
  })();

  return {
    id: row.id,
    tipo: row.tipo,
    nombre: row.nombre,
    descripcion: typeof row.descripcion === 'string' ? row.descripcion : '',
    precio: typeof row.precio === 'number' ? row.precio : null,
    precioFormatted: formatPrecio(row.precio),
    imagenes,
    primaryImage,
    destacado: Boolean(row.destacado),
    colores,
    sabores,
    saboresLabel: formatSabores(sabores),
    nicotina_mg: typeof row.nicotina_mg === 'number' ? row.nicotina_mg : null,
    stock: typeof row.stock === 'number' ? row.stock : null,
    tags,
    infoLabel,
    caracteristicas,
    metadata,
  };
};

const cortes = (cortesData ?? []).map((row) => createItem(row as GaleriaItem));
const gorras = (gorrasData ?? []).map((row) => createItem(row as GaleriaItem));
const vapes = (vapesData ?? []).map((row) => createItem(row as GaleriaItem));

const galeriaPayload = JSON.stringify({ cortes, gorras, vapes }).replace(/</g, '\\u003c');

---

<Layout
  title="Galería - JP Barber"
  description="Explora la colección de cortes, servicios y productos destacados de JP Barber."
>
  <Header />
  <main class="min-h-screen bg-gradient-to-br from-white via-gray-50 to-white dark:from-black dark:via-zinc-900 dark:to-black transition-colors duration-300">
        <!-- Hero Galería -->
        <section class="relative overflow-hidden border-b border-gray-200/50 dark:border-white/10">
            <div class="absolute inset-0">
                <div class="absolute inset-0 bg-gradient-to-br from-red-50/30 via-transparent to-red-100/30 dark:from-red-500/15 dark:via-transparent dark:to-red-600/10 transition-colors duration-300" />
                <div class="absolute -top-24 -left-32 h-72 w-72 rounded-full bg-red-400/20 dark:bg-red-500/20 blur-3xl" />
                <div class="absolute -bottom-32 -right-28 h-96 w-96 rounded-full bg-red-300/15 dark:bg-purple-500/15 blur-3xl" />
            </div>
            <div class="relative z-10 mx-auto max-w-4xl px-4 py-16 text-center md:py-20">
                <p class="text-sm uppercase tracking-[0.4em] text-red-600 dark:text-red-300/80">JP Barber Studio</p>
                <h1 class="font-montserrat text-4xl font-extrabold text-gray-900 dark:text-white md:text-5xl">
                    Explora nuestra <span class="bg-gradient-to-r from-red-500 to-red-400 bg-clip-text text-transparent">galería exclusiva</span>
                </h1>
                <p class="mt-6 text-lg text-gray-700 dark:text-gray-300 md:text-xl">
                    Inspírate con los cortes, estilos y productos premium que ofrecemos para elevar tu look al siguiente nivel.
                </p>
                <div class="mt-8 flex flex-col items-center justify-center gap-4 sm:flex-row">
                    <a href="/agendar" class="inline-flex items-center justify-center gap-2 rounded-full bg-gradient-to-r from-red-600 to-red-500 px-6 py-3 text-sm font-semibold uppercase tracking-[0.3em] text-white transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-red-500/30">
                        <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <rect width="18" height="18" x="3" y="4" rx="2" ry="2" />
                            <line x1="16" x2="16" y1="2" y2="6" />
                            <line x1="8" x2="8" y1="2" y2="6" />
                            <line x1="3" x2="21" y1="10" y2="10" />
                        </svg>
                        Agendar Cita
                    </a>
                    <a href="/cola-virtual" class="inline-flex items-center justify-center gap-2 rounded-full border border-gray-300 dark:border-white/15 bg-white/90 dark:bg-white/5 px-6 py-3 text-sm font-semibold uppercase tracking-[0.3em] text-gray-900 dark:text-white/80 transition-all duration-300 hover:border-red-400/60 hover:text-red-600 dark:hover:text-red-200">
                        <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                            <circle cx="9" cy="7" r="4" />
                            <line x1="22" x2="16" y1="11" y2="13" />
                            <line x1="16" x2="22" y1="11" y2="13" />
                        </svg>
                        Ver Cola Virtual
                    </a>
                </div>
            </div>
        </section>

        <!-- Contenido principal -->
        <section class="container mx-auto px-4 py-12">
            <!-- Navegación de secciones -->
            <div class="flex justify-center mb-12">
                <div class="bg-white/80 dark:bg-zinc-900/50 rounded-2xl p-2 border border-gray-200 dark:border-zinc-700/50 shadow-md">
                    <button
                        data-target="seccion-cortes"
                        data-active-class="bg-red-600 text-white"
                        data-inactive-class="bg-gray-100 dark:bg-zinc-800 text-gray-600 dark:text-white/60"
                        onclick="mostrarSeccion('seccion-cortes')"
                        class="nav-btn px-6 py-3 rounded-xl font-montserrat font-semibold transition-all duration-300 bg-red-600 text-white"
                    >
                        Cortes (<span data-count="cortes">{cortes.length}</span>)
                    </button>
                    <button
                        data-target="seccion-productos"
                        data-active-class="bg-red-600 text-white"
                        data-inactive-class="bg-gray-100 dark:bg-zinc-800 text-gray-600 dark:text-white/60"
                        onclick="mostrarSeccion('seccion-productos')"
                        class="nav-btn px-6 py-3 rounded-xl font-montserrat font-semibold transition-all duration-300 bg-gray-100 dark:bg-zinc-800 text-gray-600 dark:text-white/60 hover:text-gray-900 dark:hover:text-white"
                    >
                        Gorras (<span data-count="gorras">{gorras.length}</span>)
                    </button>
                    <button
                        data-target="seccion-vapes"
                        data-active-class="bg-red-600 text-white"
                        data-inactive-class="bg-gray-100 dark:bg-zinc-800 text-gray-600 dark:text-white/60"
                        onclick="mostrarSeccion('seccion-vapes')"
                        class="nav-btn px-6 py-3 rounded-xl font-montserrat font-semibold transition-all duration-300 bg-gray-100 dark:bg-zinc-800 text-gray-600 dark:text-white/60 hover:text-gray-900 dark:hover:text-white"
                    >
                        Vapes (<span data-count="vapes">{vapes.length}</span>)
                    </button>
                </div>
            </div>

            <!-- Sección de Cortes -->
            <section id="seccion-cortes" class="mb-20">
                <!-- Mensaje de Asesoría -->
                <div class="bg-gradient-to-r from-red-100 to-red-50 dark:from-red-500/10 dark:to-red-600/10 border border-red-300 dark:border-red-500/20 rounded-2xl p-6 mb-8 text-center transition-colors duration-300">
                    <h3 class="text-xl font-montserrat font-bold text-red-600 dark:text-red-400 mb-2">¿Necesitas Asesoría Personalizada?</h3>
                    <p class="text-gray-700 dark:text-white/70 mb-4">Nuestros expertos barberos pueden ayudarte a elegir el corte perfecto para tu estilo y tipo de rostro.</p>
                    <button onclick="abrirModalAsesoria()" class="inline-flex items-center px-6 py-3 bg-red-500 hover:bg-red-600 text-white font-semibold rounded-xl transition-all duration-300 transform hover:scale-105">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                        </svg>
                        Solicitar Asesoría
                    </button>
                </div>
                
                <div class="text-center mb-12">
                    <h2 class="font-montserrat text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4">Nuestros Cortes</h2>
                    <p class="text-gray-600 dark:text-white/60 text-lg">Estilos clásicos y modernos adaptados a tu personalidad</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    {cortes.length === 0 ? (
                        <div class="md:col-span-2 lg:col-span-3">
                            <div class="bg-gradient-to-br from-zinc-900/60 to-zinc-800/60 border border-zinc-700/40 rounded-3xl p-8 text-center text-white/70">
                                <p class="font-semibold text-lg">Aún no hay cortes registrados.</p>
                                <p class="text-sm text-white/50">Pronto publicaremos nuestros estilos disponibles.</p>
                            </div>
                        </div>
                    ) : (
                        cortes.map((item) => (
                            <div class="group relative bg-gradient-to-br from-white to-gray-50 dark:from-zinc-900/95 dark:to-zinc-800/95 rounded-3xl border border-gray-200 dark:border-zinc-700/50 overflow-hidden hover:border-red-500/50 transition-all duration-300 transform hover:scale-105 cursor-pointer shadow-lg" data-galeria-card data-tipo="corte" data-item-id={item.id}>
                                <div class="aspect-square bg-gradient-to-br from-zinc-800 to-zinc-700 flex items-center justify-center p-6">
                                    <img src={item.primaryImage} alt={item.nombre} class="w-full h-full object-cover rounded-2xl" loading="lazy" />
                                </div>
                                <div class="p-6">
                                    <div class="flex items-center gap-2 mb-3">
                                        <h3 class="font-montserrat text-xl font-bold text-gray-900 dark:text-white flex-1">{item.nombre}</h3>
                                        {item.destacado && (
                                            <span class="text-xs font-semibold text-red-500 bg-red-500/10 border border-red-500/30 rounded-full px-3 py-1">Destacado</span>
                                        )}
                                    </div>
                                    <p class="text-gray-600 dark:text-white/60 text-sm mb-4 line-clamp-3">{item.descripcion ?? 'Consulta con nuestros barberos para más detalles.'}</p>
                                    <div class="flex justify-between items-center">
                                        <span class="text-red-600 dark:text-red-400 font-bold text-lg">{item.precioFormatted}</span>
                                        <button type="button" class="text-sm font-semibold text-red-500 hover:text-red-300 transition-colors" data-detalle-trigger data-tipo="corte" data-item-id={item.id}>
                                            Ver detalles
                                        </button>
                                    </div>
                                </div>
                            </div>
                        ))
                    )}
                </div>
            </section>

            <!-- Sección de Productos -->
            <section id="seccion-productos" class="mb-20 hidden">
                <div class="text-center mb-12">
                    <h2 class="font-montserrat text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4">Nuestras Gorras</h2>
                    <p class="text-gray-600 dark:text-white/60 text-lg">Colección exclusiva de gorras para barberos y clientes</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    {gorras.length === 0 ? (
                        <div class="md:col-span-2 lg:col-span-3">
                            <div class="bg-gradient-to-br from-zinc-900/60 to-zinc-800/60 border border-zinc-700/40 rounded-3xl p-8 text-center text-white/70">
                                <p class="font-semibold text-lg">Aún no hay productos registrados.</p>
                                <p class="text-sm text-white/50">Muy pronto podrás encontrar nuestra colección completa de gorras.</p>
                            </div>
                        </div>
                    ) : (
                        gorras.map((item) => (
                            <div class="group relative bg-gradient-to-br from-white to-gray-50 dark:from-zinc-900/95 dark:to-zinc-800/95 rounded-3xl border border-gray-200 dark:border-zinc-700/50 overflow-hidden hover:border-red-500/50 transition-all duration-300 transform hover:scale-105 cursor-pointer shadow-lg" data-galeria-card data-tipo="gorra" data-item-id={item.id}>
                                <div class="aspect-square bg-gradient-to-br from-zinc-800 to-zinc-700 flex items-center justify-center p-6">
                                    <img src={item.primaryImage} alt={item.nombre} class="w-full h-full object-cover rounded-2xl" loading="lazy" />
                                </div>
                                <div class="p-6 space-y-4">
                                    <div class="flex items-center gap-2">
                                        <h3 class="font-montserrat text-xl font-bold text-gray-900 dark:text-white flex-1">{item.nombre}</h3>
                                        {item.destacado && (
                                            <span class="text-xs font-semibold text-red-500 bg-red-500/10 border border-red-500/30 rounded-full px-3 py-1">Destacado</span>
                                        )}
                                    </div>
                                    <p class="text-gray-600 dark:text-white/60 text-sm line-clamp-3">{item.descripcion || 'Producto exclusivo disponible en JP Barber Studio.'}</p>
                                    <div class="flex flex-wrap gap-2 text-xs text-gray-500 dark:text-white/50">
                                        {item.infoLabel && (
                                            <span class="bg-gray-200 dark:bg-white/10 px-2 py-1 rounded-full border border-gray-300/30 dark:border-white/10">{item.infoLabel}</span>
                                        )}
                                        {typeof item.stock === 'number' && (
                                            <span class="bg-gray-200 dark:bg-white/10 px-2 py-1 rounded-full border border-gray-300/30 dark:border-white/10">Stock: {item.stock}</span>
                                        )}
                                    </div>
                                    {item.colores?.length ? (
                                        <div class="flex flex-wrap items-center gap-2">
                                            <span class="text-xs text-gray-500 dark:text-white/50 uppercase tracking-wider">Colores:</span>
                                            {item.colores.map((color) => (
                                                <span class="text-xs bg-gray-100 dark:bg-white/10 text-gray-700 dark:text-white px-2 py-1 rounded-full">{color}</span>
                                            ))}
                                        </div>
                                    ) : null}
                                    {item.tags?.length ? (
                                        <div class="flex flex-wrap gap-2">
                                            {item.tags.map((tag) => (
                                                <span class="text-xs bg-blue-600/90 text-white px-2 py-1 rounded-full">#{tag}</span>
                                            ))}
                                        </div>
                                    ) : null}
                                    <div class="flex items-center justify-between pt-2">
                                        <span class="text-red-600 dark:text-red-400 font-bold text-lg">{item.precioFormatted}</span>
                                        <button type="button" class="text-sm font-semibold text-red-500 hover:text-red-300 transition-colors" data-detalle-trigger data-tipo="gorra" data-item-id={item.id}>
                                            Ver detalles
                                        </button>
                                    </div>
                                </div>
                            </div>
                        ))
                    )}
                </div>
            </section>

            <!-- Sección de Vapes -->
            <section id="seccion-vapes" class="mb-20 hidden">
                <div class="text-center mb-12">
                    <h2 class="font-montserrat text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4">Vapes Exclusivos</h2>
                    <p class="text-gray-600 dark:text-white/60 text-lg">Blend de sabores premium curados por JP Barber</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    {vapes.length === 0 ? (
                        <div class="md:col-span-2 lg:col-span-3">
                            <div class="bg-gradient-to-br from-red-500/10 via-purple-500/10 to-red-600/10 border border-red-500/20 rounded-3xl p-8 text-center text-white/80">
                                <p class="font-semibold text-lg">Pronto tendremos vapes disponibles.</p>
                                <p class="text-sm text-white/60">Estamos preparando una selección exclusiva de vapes para ti.</p>
                            </div>
                        </div>
                    ) : (
                        vapes.map((item) => (
                            <div class="group relative bg-gradient-to-br from-white to-rose-50 dark:from-zinc-900/95 dark:to-zinc-800/95 rounded-3xl border border-rose-200/60 dark:border-rose-500/20 overflow-hidden hover:border-red-500/50 transition-all duration-300 transform hover:scale-105 cursor-pointer shadow-lg" data-galeria-card data-tipo="vape" data-item-id={item.id}>
                                <div class="aspect-square bg-gradient-to-br from-red-500/30 via-purple-500/20 to-red-400/20 flex items-center justify-center p-6">
                                    <img src={item.primaryImage} alt={item.nombre} class="w-full h-full object-cover rounded-2xl" loading="lazy" />
                                </div>
                                <div class="p-6 space-y-4">
                                    <div class="flex items-center gap-2">
                                        <h3 class="font-montserrat text-xl font-bold text-gray-900 dark:text-white flex-1">{item.nombre}</h3>
                                        {item.destacado && (
                                            <span class="text-xs font-semibold text-red-500 bg-red-500/10 border border-red-500/30 rounded-full px-3 py-1">Best Seller</span>
                                        )}
                                    </div>
                                    <p class="text-gray-600 dark:text-white/60 text-sm line-clamp-3">{item.descripcion || 'Experiencia de vapeo seleccionada especialmente para nuestros clientes.'}</p>
                                    <div class="flex flex-wrap gap-2 text-xs text-red-500 dark:text-red-300">
                                        {item.saboresLabel && (
                                            <span class="bg-red-500/10 border border-red-500/20 px-2 py-1 rounded-full">Sabores: {item.saboresLabel}</span>
                                        )}
                                        {typeof item.nicotina_mg === 'number' && (
                                            <span class="bg-red-500/10 border border-red-500/20 px-2 py-1 rounded-full">Nicotina: {item.nicotina_mg} mg</span>
                                        )}
                                        {typeof item.stock === 'number' && (
                                            <span class="bg-red-500/10 border border-red-500/20 px-2 py-1 rounded-full">Stock: {item.stock}</span>
                                        )}
                                    </div>
                                    {item.tags?.length ? (
                                        <div class="flex flex-wrap gap-2">
                                            {item.tags.map((tag) => (
                                                <span class="text-xs bg-purple-600/90 text-white px-2 py-1 rounded-full">#{tag}</span>
                                            ))}
                                        </div>
                                    ) : null}
                                    <div class="flex items-center justify-between pt-2">
                                        <span class="text-red-600 dark:text-red-400 font-bold text-lg">{item.precioFormatted}</span>
                                        <button type="button" class="text-sm font-semibold text-red-500 hover:text-red-300 transition-colors" data-detalle-trigger data-tipo="vape" data-item-id={item.id}>
                                            Ver detalles
                                        </button>
                                    </div>
                                </div>
                            </div>
                        ))
                    )}
                </div>
            </section>

        <!-- Modal de Detalle -->
        <div id="modalDetalle" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
            <div class="bg-gradient-to-br from-zinc-900/95 to-zinc-800/95 rounded-3xl border border-zinc-700/50 max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-gradient-to-br from-zinc-900/95 to-zinc-800/95 p-6 border-b border-zinc-700/50 flex justify-between items-center">
                    <h2 id="modalTitulo" class="font-montserrat text-2xl font-bold text-white">Detalle</h2>
                    <button onclick="cerrarModalDetalle()" class="text-white/60 hover:text-white transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="p-6">
                    <!-- Layout mejorado con flexbox -->
                    <div class="flex flex-col lg:flex-row gap-8">
                        <!-- Sección de galería -->
                        <div class="lg:w-2/3">
                            <!-- Imagen principal -->
                            <div class="relative mb-4">
                                <div class="aspect-video bg-gradient-to-br from-zinc-800 to-zinc-700 rounded-2xl overflow-hidden shadow-2xl">
                                    <img id="imagenPrincipal" src="" alt="" class="w-full h-full object-cover transition-all duration-500">
                                </div>
                                
                                <!-- Controles de navegación mejorados -->
                                <button id="btnAnterior" onclick="cambiarImagen(-1)" class="absolute left-3 top-1/2 transform -translate-y-1/2 bg-black/60 hover:bg-black/80 text-white p-3 rounded-full transition-all duration-300 hover:scale-110 backdrop-blur-sm">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                    </svg>
                                </button>
                                <button id="btnSiguiente" onclick="cambiarImagen(1)" class="absolute right-3 top-1/2 transform -translate-y-1/2 bg-black/60 hover:bg-black/80 text-white p-3 rounded-full transition-all duration-300 hover:scale-110 backdrop-blur-sm">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                    </svg>
                                </button>
                                
                                <!-- Indicadores mejorados -->
                                <div id="indicadores" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2 bg-black/30 px-3 py-2 rounded-full backdrop-blur-sm"></div>
                            </div>
                            
                            <!-- Miniaturas mejoradas -->
                            <div class="overflow-hidden">
                                <div id="miniaturas" class="flex gap-3 overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-zinc-600 scrollbar-track-transparent"></div>
                            </div>
                        </div>
                        
                        <!-- Sección de información -->
                        <div class="lg:w-1/3 flex flex-col">
                            <!-- Información principal -->
                            <div class="mb-6">
                                <h3 id="detalleNombre" class="font-montserrat text-2xl lg:text-3xl font-bold text-white mb-4"></h3>
                                <p id="detalleDescripcion" class="text-white/70 mb-6 leading-relaxed text-sm lg:text-base"></p>
                                
                                <!-- Características con mejor diseño -->
                                <div class="mb-6">
                                    <h4 class="text-white font-semibold mb-3 text-lg">Características:</h4>
                                    <div id="detalleCaracteristicas" class="space-y-3"></div>
                                </div>
                            </div>
                            
                            <!-- Panel de precio y acciones -->
                            <div class="bg-gradient-to-br from-zinc-800/80 to-zinc-700/80 rounded-2xl p-6 border border-zinc-600/30 backdrop-blur-sm mt-auto">
                                <div class="flex flex-col sm:flex-row lg:flex-col justify-between items-start lg:items-center mb-6">
                                    <span id="detallePrecio" class="text-red-400 font-bold text-3xl lg:text-4xl mb-2 lg:mb-0"></span>
                                    <span id="detalleInfo" class="text-white/60 text-sm lg:text-base"></span>
                                </div>
                                
                                <div class="space-y-3">
                                    <button class="w-full px-6 py-4 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-semibold rounded-xl transition-all duration-300 transform hover:scale-105 hover:shadow-lg hover:shadow-red-500/25">
                                        <span class="flex items-center justify-center gap-2">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                            </svg>
                                            Reservar Cita
                                        </span>
                                    </button>
                                    
                                    <button onclick="abrirModalAsesoria()" class="w-full px-6 py-4 bg-zinc-700/80 hover:bg-zinc-600/80 text-white font-semibold rounded-xl transition-all duration-300 border border-zinc-600/50 hover:border-zinc-500/50">
                                        <span class="flex items-center justify-center gap-2">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                            Solicitar Asesoría
                                        </span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

            <!-- Call to Action -->
            <section class="text-center">
                <div class="bg-gradient-to-r from-red-600/20 to-red-800/20 rounded-3xl border border-red-500/30 p-8 md:p-12">
                    <h2 class="font-montserrat text-2xl md:text-3xl font-bold text-white mb-4">
                        ¿Listo para tu nuevo look?
                    </h2>
                    <p class="text-white/70 text-lg mb-8 max-w-2xl mx-auto">
                        Agenda tu cita ahora y experimenta el mejor servicio de barbería en la ciudad
                    </p>
                    <div class="flex justify-center">
                        <a href="/agendar" class="inline-flex items-center justify-center gap-2 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold py-4 px-8 rounded-2xl transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 shadow-lg hover:shadow-red-500/25">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect>
                                <line x1="16" x2="16" y1="2" y2="6"></line>
                                <line x1="8" x2="8" y1="2" y2="6"></line>
                                <line x1="3" x2="21" y1="10" y2="10"></line>
                            </svg>
                            Agendar Cita
                        </a>
                    </div>
                </div>
            </section>
        </section>

        <!-- Modal de Asesoría -->
        <div id="modalAsesoria" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
            <div class="bg-gradient-to-br from-zinc-900 to-zinc-800 rounded-3xl border border-zinc-700/50 max-w-md w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <!-- Header del Modal -->
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-montserrat font-bold text-white">Solicitar Asesoría</h2>
                        <button onclick="cerrarModalAsesoria()" class="text-white/60 hover:text-white transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>

                    <!-- Formulario de Asesoría -->
                    <form id="formAsesoria" class="space-y-4">
                        <div>
                            <label for="nombre" class="block text-white/80 text-sm font-medium mb-2">Nombre Completo</label>
                            <input type="text" id="nombre" name="nombre" required class="w-full px-4 py-3 bg-zinc-800/50 border border-zinc-600/50 rounded-xl text-white placeholder-white/40 focus:border-red-500 focus:outline-none transition-colors" placeholder="Tu nombre completo">
                        </div>

                        <div>
                            <label for="telefono" class="block text-white/80 text-sm font-medium mb-2">Teléfono</label>
                            <input type="tel" id="telefono" name="telefono" required class="w-full px-4 py-3 bg-zinc-800/50 border border-zinc-600/50 rounded-xl text-white placeholder-white/40 focus:border-red-500 focus:outline-none transition-colors" placeholder="Tu número de teléfono">
                        </div>

                        <div>
                            <label for="email" class="block text-white/80 text-sm font-medium mb-2">Email (Opcional)</label>
                            <input type="email" id="email" name="email" class="w-full px-4 py-3 bg-zinc-800/50 border border-zinc-600/50 rounded-xl text-white placeholder-white/40 focus:border-red-500 focus:outline-none transition-colors" placeholder="tu@email.com">
                        </div>

                        <div>
                            <label for="tipoRostro" class="block text-white/80 text-sm font-medium mb-2">Tipo de Rostro</label>
                            <select id="tipoRostro" name="tipoRostro" class="w-full px-4 py-3 bg-zinc-800/50 border border-zinc-600/50 rounded-xl text-white focus:border-red-500 focus:outline-none transition-colors">
                                <option value="">Selecciona tu tipo de rostro</option>
                                <option value="ovalado">Ovalado</option>
                                <option value="redondo">Redondo</option>
                                <option value="cuadrado">Cuadrado</option>
                                <option value="rectangular">Rectangular</option>
                                <option value="triangular">Triangular</option>
                                <option value="no-se">No estoy seguro</option>
                            </select>
                        </div>

                        <div>
                            <label for="estiloPreferido" class="block text-white/80 text-sm font-medium mb-2">Estilo Preferido</label>
                            <select id="estiloPreferido" name="estiloPreferido" class="w-full px-4 py-3 bg-zinc-800/50 border border-zinc-600/50 rounded-xl text-white focus:border-red-500 focus:outline-none transition-colors">
                                <option value="">¿Qué estilo buscas?</option>
                                <option value="clasico">Clásico y elegante</option>
                                <option value="moderno">Moderno y trendy</option>
                                <option value="casual">Casual y relajado</option>
                                <option value="profesional">Profesional</option>
                                <option value="atrevido">Atrevido y único</option>
                            </select>
                        </div>

                        <div>
                            <label for="comentarios" class="block text-white/80 text-sm font-medium mb-2">Comentarios Adicionales</label>
                            <textarea id="comentarios" name="comentarios" rows="3" class="w-full px-4 py-3 bg-zinc-800/50 border border-zinc-600/50 rounded-xl text-white placeholder-white/40 focus:border-red-500 focus:outline-none transition-colors resize-none" placeholder="Cuéntanos más sobre lo que buscas..."></textarea>
                        </div>

                        <div class="flex gap-3 pt-4">
                            <button type="button" onclick="cerrarModalAsesoria()" class="flex-1 px-6 py-3 bg-zinc-700 hover:bg-zinc-600 text-white font-semibold rounded-xl transition-colors">
                                Cancelar
                            </button>
                            <button type="submit" class="flex-1 px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-semibold rounded-xl transition-all duration-300 transform hover:scale-105">
                                Enviar Solicitud
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-black/50 border-t border-zinc-800/50 py-8">
            <div class="container mx-auto px-4 text-center">
                <p class="text-zinc-400 text-sm">
                    © {new Date().getFullYear()} Torres Barber. Todos los derechos reservados.
                </p>
            </div>
        </footer>
  </main>
  <Footer />
</Layout>

<script is:inline>
    // Función para mostrar/ocultar secciones
    function mostrarSeccion(seccionId) {
        // Ocultar todas las secciones
        document.getElementById('seccion-cortes').classList.add('hidden');
        document.getElementById('seccion-productos').classList.add('hidden');
        
        // Mostrar la sección seleccionada
        document.getElementById(seccionId).classList.remove('hidden');
        
        // Actualizar botones activos
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.classList.remove('bg-red-600', 'text-white');
            btn.classList.add('bg-zinc-800', 'text-white/60');
        });
        
        // Activar el botón correspondiente
        const btnActivo = document.querySelector(`[onclick="mostrarSeccion('${seccionId}')"]`);
        if (btnActivo) {
            btnActivo.classList.remove('bg-zinc-800', 'text-white/60');
            btnActivo.classList.add('bg-red-600', 'text-white');
        }
    }
    
    // Funciones para el modal de asesoría
    function abrirModalAsesoria() {
        document.getElementById('modalAsesoria').classList.remove('hidden');
        document.body.style.overflow = 'hidden';
    }
    
    function cerrarModalAsesoria() {
        document.getElementById('modalAsesoria').classList.add('hidden');
        document.body.style.overflow = 'auto';
        // Limpiar formulario
        document.getElementById('formAsesoria').reset();
    }
    
    // Cerrar modal al hacer clic fuera de él
    document.addEventListener('click', function(e) {
        const modal = document.getElementById('modalAsesoria');
        if (e.target === modal) {
            cerrarModalAsesoria();
        }
    });
    
    // Manejar envío del formulario de asesoría
    document.addEventListener('DOMContentLoaded', function() {
        const formAsesoria = document.getElementById('formAsesoria');
        if (formAsesoria) {
            formAsesoria.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Obtener datos del formulario
                const formData = new FormData(this);
                const datos = {
                    nombre: formData.get('nombre'),
                    telefono: formData.get('telefono'),
                    email: formData.get('email'),
                    tipoRostro: formData.get('tipoRostro'),
                    estiloPreferido: formData.get('estiloPreferido'),
                    comentarios: formData.get('comentarios')
                };
                
                // Simular envío (aquí se conectaría con el backend)
                console.log('Datos de asesoría:', datos);
                
                // Mostrar mensaje de confirmación
                alert('¡Gracias! Tu solicitud de asesoría ha sido enviada. Nos pondremos en contacto contigo pronto.');
                
                // Cerrar modal
                cerrarModalAsesoria();
            });
        }
    });
    
    // Variables globales para el modal de detalle
    let imagenActual = 0;
    let imagenesActuales = [];
    let datosActuales = {};
    let tipoActual = '';
    let idActual = '';
    let cortesDisponibles = ['clasico', 'fade', 'undercut', 'combo', 'infantil', 'afeitado'];
    let corteActualIndex = 0;
    
    // Base de datos de cortes y productos
    const datosItems = {
        corte: {
            clasico: {
                nombre: "Corte Clásico",
                descripcion: "Estilo tradicional y elegante, perfecto para cualquier ocasión profesional. Nuestro corte clásico combina técnicas tradicionales con un acabado moderno, ideal para hombres que buscan un look sofisticado y atemporal.",
                precio: "$25.000",
                info: "45 min",
                caracteristicas: [
                    "Corte con tijeras y máquina",
                    "Acabado con navaja",
                    "Peinado incluido",
                    "Lavado con champú premium"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1621605815971-fbc98d665033?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=800&h=600&fit=crop&crop=center"
                ]
            },
            fade: {
                nombre: "Fade Moderno",
                descripcion: "Degradado perfecto con técnicas contemporáneas y acabado impecable. El fade moderno es una técnica que requiere precisión y experiencia, creando una transición suave desde el cabello más largo hasta la piel.",
                precio: "$30.000",
                info: "60 min",
                caracteristicas: [
                    "Degradado profesional",
                    "Múltiples niveles de fade",
                    "Acabado con detalle",
                    "Productos de styling incluidos"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1621605815971-fbc98d665033?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=800&h=600&fit=crop&crop=center"
                ]
            },
            undercut: {
                nombre: "Undercut Texturizado",
                descripcion: "Estilo moderno con textura y volumen en la parte superior. El undercut texturizado combina un corte lateral muy corto con cabello más largo arriba, creando contraste y personalidad.",
                precio: "$35.000",
                info: "50 min",
                caracteristicas: [
                    "Corte undercut preciso",
                    "Texturizado con tijeras",
                    "Styling personalizado",
                    "Productos texturizantes"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1621605815971-fbc98d665033?w=800&h=600&fit=crop&crop=center"
                ]
            },
            combo: {
                nombre: "Combo Completo",
                descripcion: "Corte + arreglo de barba + tratamiento facial completo. La experiencia más completa en nuestra barbería, incluyendo todos nuestros servicios premium para un resultado excepcional.",
                precio: "$45.000",
                info: "90 min",
                caracteristicas: [
                    "Corte personalizado",
                    "Arreglo de barba profesional",
                    "Tratamiento facial",
                    "Masaje relajante",
                    "Productos premium incluidos"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1503951914875-452162b0f3f1?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1493256338651-d82f7acb2b38?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1621605815971-fbc98d665033?w=800&h=600&fit=crop&crop=center"
                ]
            },
            infantil: {
                nombre: "Corte Infantil",
                descripcion: "Especial para niños, ambiente divertido y seguro. Nuestros barberos están especializados en trabajar con niños, creando un ambiente cómodo y divertido para los más pequeños.",
                precio: "$20.000",
                info: "30 min",
                caracteristicas: [
                    "Ambiente amigable para niños",
                    "Barberos especializados",
                    "Cortes modernos y clásicos",
                    "Paciencia y cuidado especial"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1621605815971-fbc98d665033?w=800&h=600&fit=crop&crop=center"
                ]
            },
            afeitado: {
                nombre: "Afeitado Clásico",
                descripcion: "Con navaja tradicional, toallas calientes y aceites premium. Una experiencia de afeitado tradicional que combina técnicas clásicas con productos de la más alta calidad.",
                precio: "$25.000",
                info: "40 min",
                caracteristicas: [
                    "Navaja tradicional",
                    "Toallas calientes",
                    "Aceites y bálsamos premium",
                    "Técnica tradicional"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1493256338651-d82f7acb2b38?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1503951914875-452162b0f3f1?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1621605815971-fbc98d665033?w=800&h=600&fit=crop&crop=center"
                ]
            }
        },
        producto: {
            snapback: {
                nombre: "Snapback Clásica",
                descripcion: "Gorra negra con logo bordado. Ajuste perfecto y estilo atemporal. Fabricada con materiales de alta calidad, esta gorra representa el estilo clásico de nuestra barbería.",
                precio: "$35.000",
                info: "Ajustable",
                caracteristicas: [
                    "100% algodón premium",
                    "Logo bordado de alta calidad",
                    "Ajuste snapback",
                    "Visera plana",
                    "Diseño atemporal"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1588850561407-ed78c282e89b?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1521369909029-2afed882baee?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1575428652377-a2d80e2277fc?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1556306535-38febf6782e7?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1506629905607-bb5c3769b996?w=800&h=600&fit=crop&crop=center"
                ]
            },
            trucker: {
                nombre: "Trucker Vintage",
                descripcion: "Estilo retro con malla trasera. Perfecta para el look barbero clásico. Esta gorra combina el estilo vintage con la comodidad moderna, ideal para el día a día.",
                precio: "$28.000",
                info: "Ajustable",
                caracteristicas: [
                    "Frente de algodón",
                    "Malla trasera transpirable",
                    "Estilo vintage",
                    "Ajuste con snapback",
                    "Diseño retro auténtico"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1521369909029-2afed882baee?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1588850561407-ed78c282e89b?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1575428652377-a2d80e2277fc?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1576871337622-98d48d1cf531?w=800&h=600&fit=crop&crop=center"
                ]
            },
            dadhat: {
                nombre: "Dad Hat Minimalista",
                descripcion: "Diseño limpio y elegante. Ideal para uso diario y profesional. La simplicidad y elegancia se combinan en esta gorra perfecta para cualquier ocasión.",
                precio: "$32.000",
                info: "100% algodón",
                caracteristicas: [
                    "Diseño minimalista",
                    "Algodón 100% premium",
                    "Ajuste cómodo",
                    "Visera curvada",
                    "Logo discreto bordado"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1575428652377-a2d80e2277fc?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1588850561407-ed78c282e89b?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1521369909029-2afed882baee?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1556306535-38febf6782e7?w=800&h=600&fit=crop&crop=center"
                ]
            },
            beanie: {
                nombre: "Beanie Urbana",
                descripcion: "Gorro de lana para temporada fría. Estilo street con logo bordado. Perfecto para los meses más fríos, combinando calidez y estilo urbano.",
                precio: "$25.000",
                info: "Lana premium",
                caracteristicas: [
                    "Lana merino premium",
                    "Diseño urbano moderno",
                    "Logo bordado",
                    "Ajuste cómodo",
                    "Ideal para invierno"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1576871337622-98d48d1cf531?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1588850561407-ed78c282e89b?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1521369909029-2afed882baee?w=800&h=600&fit=crop&crop=center"
                ]
            },
            bucket: {
                nombre: "Bucket Hat Trendy",
                descripcion: "Estilo moderno y versátil. Protección solar con diseño urbano. La tendencia del momento en un diseño funcional y con estilo.",
                precio: "$30.000",
                info: "Reversible",
                caracteristicas: [
                    "Diseño reversible",
                    "Protección UV",
                    "Estilo trendy",
                    "Material resistente",
                    "Ala ancha funcional"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1506629905607-bb5c3769b996?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1588850561407-ed78c282e89b?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1521369909029-2afed882baee?w=800&h=600&fit=crop&crop=center"
                ]
            },
            limitada: {
                nombre: "Edición Limitada",
                descripcion: "Gorra exclusiva con bordado premium. Solo 50 unidades disponibles. Una pieza única para coleccionistas y amantes del estilo exclusivo.",
                precio: "$45.000",
                info: "Exclusiva",
                caracteristicas: [
                    "Edición limitada (50 unidades)",
                    "Bordado premium en oro",
                    "Materiales exclusivos",
                    "Numeración individual",
                    "Certificado de autenticidad"
                ],
                imagenes: [
                    "https://images.unsplash.com/photo-1556306535-38febf6782e7?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1588850561407-ed78c282e89b?w=800&h=600&fit=crop&crop=center",
                    "https://images.unsplash.com/photo-1521369909029-2afed882baee?w=800&h=600&fit=crop&crop=center"
                ]
            }
        }
    };
    
    // Función para abrir modal de detalle
    function abrirModalDetalle(tipo, id) {
        const item = datosItems[tipo][id];
        if (!item) return;
        
        tipoActual = tipo;
        idActual = id;
        datosActuales = item;
        imagenesActuales = item.imagenes;
        imagenActual = 0;
        
        // Si es un corte, establecer el índice actual
        if (tipo === 'corte') {
            corteActualIndex = cortesDisponibles.indexOf(id);
        }
        
        // Llenar información
        document.getElementById('modalTitulo').textContent = item.nombre;
        document.getElementById('detalleNombre').textContent = item.nombre;
        document.getElementById('detalleDescripcion').textContent = item.descripcion;
        document.getElementById('detallePrecio').textContent = item.precio;
        document.getElementById('detalleInfo').textContent = item.info;
        
        // Llenar características
        const caracteristicasDiv = document.getElementById('detalleCaracteristicas');
        caracteristicasDiv.innerHTML = '';
        item.caracteristicas.forEach(caracteristica => {
            const div = document.createElement('div');
            div.className = 'flex items-center text-white/80';
            div.innerHTML = `
                <svg class="w-4 h-4 text-red-400 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                </svg>
                ${caracteristica}
            `;
            caracteristicasDiv.appendChild(div);
        });
        
        // Configurar galería
        actualizarGaleria();
        
        // Mostrar modal
        const modal = document.getElementById('modalDetalle');
        modal.classList.remove('hidden');
        modal.classList.add('flex');
        document.body.style.overflow = 'hidden';
    }
    
    // Función para cerrar modal de detalle
    function cerrarModalDetalle() {
        const modal = document.getElementById('modalDetalle');
        modal.classList.add('hidden');
        modal.classList.remove('flex');
        document.body.style.overflow = 'auto';
    }
    
    // Función para cambiar imagen (navega entre imágenes del mismo item)
    function cambiarImagen(direccion) {
        // Cambiar índice de imagen
        imagenActual += direccion;
        
        // Mantener el índice dentro del rango
        if (imagenActual >= imagenesActuales.length) imagenActual = 0;
        if (imagenActual < 0) imagenActual = imagenesActuales.length - 1;
        
        actualizarGaleria();
    }
    
    // Función para actualizar galería
    function actualizarGaleria() {
        const imagenPrincipal = document.getElementById('imagenPrincipal');
        const indicadores = document.getElementById('indicadores');
        const miniaturas = document.getElementById('miniaturas');
        const btnAnterior = document.getElementById('btnAnterior');
        const btnSiguiente = document.getElementById('btnSiguiente');
        
        // Actualizar imagen principal
        imagenPrincipal.src = imagenesActuales[imagenActual];
        imagenPrincipal.alt = datosActuales.nombre;
        
        // Mostrar/ocultar botones según el tipo
        if (tipoActual === 'corte') {
            // Para cortes: siempre mostrar botones para navegar entre cortes
            btnAnterior.style.display = 'block';
            btnSiguiente.style.display = 'block';
        } else {
            // Para productos: mostrar solo si hay múltiples imágenes
            if (imagenesActuales.length <= 1) {
                btnAnterior.style.display = 'none';
                btnSiguiente.style.display = 'none';
            } else {
                btnAnterior.style.display = 'block';
                btnSiguiente.style.display = 'block';
            }
        }
        
        // Actualizar indicadores
        indicadores.innerHTML = '';
        if (tipoActual === 'corte') {
            // Para cortes: mostrar indicadores de cortes
            cortesDisponibles.forEach((corteId, index) => {
                const corte = datosItems.corte[corteId];
                const indicador = document.createElement('button');
                indicador.className = `px-2 py-1 text-xs rounded-full transition-all ${
                    index === corteActualIndex ? 'bg-red-500 text-white' : 'bg-white/20 text-white/60 hover:bg-white/30'
                }`;
                indicador.textContent = corte.nombre.split(' ')[0]; // Primera palabra del nombre
                indicador.onclick = () => {
                    corteActualIndex = index;
                    cambiarImagen(0); // Llamar con 0 para actualizar sin cambiar dirección
                };
                indicadores.appendChild(indicador);
            });
        } else {
            // Para productos: mostrar indicadores de imágenes solo si hay múltiples
            if (imagenesActuales.length > 1) {
                imagenesActuales.forEach((_, index) => {
                    const indicador = document.createElement('button');
                    indicador.className = `w-2 h-2 rounded-full transition-all ${
                        index === imagenActual ? 'bg-red-500' : 'bg-white/30'
                    }`;
                    indicador.onclick = () => {
                        imagenActual = index;
                        actualizarGaleria();
                    };
                    indicadores.appendChild(indicador);
                });
            }
        }
        
        // Actualizar miniaturas
        miniaturas.innerHTML = '';
        if (tipoActual === 'corte') {
            // Para cortes: mostrar miniaturas de diferentes cortes
            cortesDisponibles.forEach((corteId, index) => {
                const corte = datosItems.corte[corteId];
                const miniatura = document.createElement('button');
                miniatura.className = `flex-shrink-0 w-20 h-20 rounded-xl overflow-hidden border-2 transition-all ${
                    index === corteActualIndex ? 'border-red-500' : 'border-zinc-600 hover:border-zinc-500'
                }`;
                miniatura.innerHTML = `
                    <img src="${corte.imagenes[0]}" alt="${corte.nombre}" class="w-full h-full object-cover">
                    <div class="absolute inset-0 bg-black/50 flex items-end p-1">
                        <span class="text-white text-xs font-medium">${corte.nombre.split(' ')[0]}</span>
                    </div>
                `;
                miniatura.style.position = 'relative';
                miniatura.onclick = () => {
                    corteActualIndex = index;
                    cambiarImagen(0);
                };
                miniaturas.appendChild(miniatura);
            });
        } else {
            // Para productos: mostrar miniaturas de imágenes del mismo producto
            if (imagenesActuales.length > 1) {
                imagenesActuales.forEach((imagen, index) => {
                    const miniatura = document.createElement('button');
                    miniatura.className = `flex-shrink-0 w-20 h-20 rounded-xl overflow-hidden border-2 transition-all ${
                        index === imagenActual ? 'border-red-500' : 'border-zinc-600 hover:border-zinc-500'
                    }`;
                    miniatura.innerHTML = `<img src="${imagen}" alt="" class="w-full h-full object-cover">`;
                    miniatura.onclick = () => {
                        imagenActual = index;
                        actualizarGaleria();
                    };
                    miniaturas.appendChild(miniatura);
                });
            }
        }
    }
    
    // Cerrar modal al hacer clic fuera
    document.getElementById('modalDetalle').addEventListener('click', function(e) {
        if (e.target === this) {
            cerrarModalDetalle();
        }
    });
    
    // Navegación con teclado
    document.addEventListener('keydown', function(e) {
        const modal = document.getElementById('modalDetalle');
        if (!modal.classList.contains('hidden')) {
            if (e.key === 'Escape') {
                cerrarModalDetalle();
            } else if (e.key === 'ArrowLeft') {
                cambiarImagen(-1);
            } else if (e.key === 'ArrowRight') {
                cambiarImagen(1);
            }
        }
    });

    // Inicializar mostrando la sección de cortes
    document.addEventListener('DOMContentLoaded', function() {
        mostrarSeccion('seccion-cortes');
    });
</script>

<style>
    /* Animaciones personalizadas */
    @keyframes fade-in-up {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .animate-fade-in-up {
        animation: fade-in-up 0.6s ease-out forwards;
    }
    
    /* Efectos de hover mejorados */
    .hover-lift {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .hover-lift:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }
    
    /* Estilos personalizados para la barra de scroll */
    ::-webkit-scrollbar {
        width: 12px;
    }
    
    ::-webkit-scrollbar-track {
        background: #18181b;
        border-radius: 10px;
        border: 1px solid #27272a;
    }
    
    ::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #dc2626, #b91c1c);
        border-radius: 10px;
        border: 2px solid #18181b;
        transition: all 0.3s ease;
    }
    
    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #ef4444, #dc2626);
        transform: scale(1.1);
    }
    
    ::-webkit-scrollbar-thumb:active {
        background: linear-gradient(180deg, #b91c1c, #991b1b);
    }
    
    /* Para Firefox */
    * {
        scrollbar-width: thin;
        scrollbar-color: #dc2626 #18181b;
    }
    
    /* Estilos específicos para el modal */
    #modalAsesoria ::-webkit-scrollbar {
        width: 8px;
    }
    
    #modalAsesoria ::-webkit-scrollbar-track {
        background: #27272a;
        border-radius: 6px;
    }
    
    #modalAsesoria ::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #dc2626, #b91c1c);
        border-radius: 6px;
        border: 1px solid #27272a;
    }
    
    #modalAsesoria ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #ef4444, #dc2626);
    }
</style>